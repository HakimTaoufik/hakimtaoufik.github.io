---
import { SITE_TITLE } from '../consts';
import HeaderLink from './HeaderLink.astro';
---

<header>
	<nav>
		<h2><a href="/">{SITE_TITLE}</a></h2>
		<div class="internal-links">
			<HeaderLink href="/">Home</HeaderLink>
			<HeaderLink href="/projects">Projects</HeaderLink>
			<HeaderLink href="/blog">Tools</HeaderLink>
			<HeaderLink href="/about">About</HeaderLink>
		</div>
		<div class="icon-links">
			<a href="https://github.com/HakimTaoufik" target="_blank">
				<span class="sr-only">GitHub</span>
				<svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32"
					><path
						fill="currentColor"
						d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
					></path></svg
				>
			</a>
			<a href="https://twitter.com/" target="_blank">
				<span class="sr-only">Twitter / X</span>
				<svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32"
					><path
						fill="currentColor"
						d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"
					></path></svg
				>
			</a>
			<a href="mailto:al-hakim.taoufik@polytechnique.edu">
				<span class="sr-only">Email</span>
				<svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32"
					><path fill="currentColor" d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555z"></path><path
						fill="currentColor"
						d="M0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.143L9.238 8.83 8 9.586 6.761 8.83zM16 4.697l-5.803 3.546L16 11.8V4.697z"
					></path></svg
				>
			</a>
			<span class="separator">|</span>
			<button id="theme-toggle" aria-label="Toggle theme">
				<svg class="icon-sun" viewBox="0 0 16 16" aria-hidden="true" width="32" height="32"
					><path
						fill="currentColor"
						d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8ZM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0Zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13Zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5ZM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8Zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.414a.5.5 0 1 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0Zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0Zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707ZM3.757 4.464a.5.5 0 0 1-.707 0L1.636 3.05a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707Z"
					></path></svg
				>
				<svg class="icon-moon" viewBox="0 0 16 16" aria-hidden="true" width="32" height="32"
					><path
						fill="currentColor"
						d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278Z"
					></path></svg
				>
			</button>
			<button
				id="menu-toggle"
				class="menu-toggle"
				type="button"
				aria-label="Open navigation menu"
				aria-controls="mobile-menu"
				aria-expanded="false"
			>
				<span>Menu</span>
			</button>
		</div>
	</nav>
	<div id="mobile-menu" class="mobile-menu" hidden>
		<div class="mobile-links">
			<HeaderLink href="/">Home</HeaderLink>
			<HeaderLink href="/projects">Projects</HeaderLink>
			<HeaderLink href="/blog">Tools</HeaderLink>
			<HeaderLink href="/about">About</HeaderLink>
		</div>
		<div class="mobile-social-links">
			<a href="https://github.com/HakimTaoufik" target="_blank" rel="noopener noreferrer">GitHub</a>
			<a href="https://twitter.com/" target="_blank" rel="noopener noreferrer">X</a>
			<a href="mailto:al-hakim.taoufik@polytechnique.edu">Email</a>
		</div>
	</div>
</header>

<script is:inline>
	(function () {
		var themeBtn = document.getElementById('theme-toggle');
		if (themeBtn) {
			themeBtn.addEventListener('click', function () {
				var current = document.documentElement.getAttribute('data-theme') || 'dark';
				var next = current === 'dark' ? 'light' : 'dark';
				document.documentElement.setAttribute('data-theme', next);
				localStorage.setItem('theme', next);
			});
		}

		var menuBtn = document.getElementById('menu-toggle');
		var mobileMenu = document.getElementById('mobile-menu');
		if (!menuBtn || !mobileMenu) return;

		function closeMenu() {
			menuBtn.setAttribute('aria-expanded', 'false');
			menuBtn.setAttribute('aria-label', 'Open navigation menu');
			mobileMenu.setAttribute('hidden', '');
		}

		menuBtn.addEventListener('click', function () {
			var expanded = menuBtn.getAttribute('aria-expanded') === 'true';
			if (expanded) {
				closeMenu();
				return;
			}

			menuBtn.setAttribute('aria-expanded', 'true');
			menuBtn.setAttribute('aria-label', 'Close navigation menu');
			mobileMenu.removeAttribute('hidden');
		});

		mobileMenu.querySelectorAll('a').forEach(function (link) {
			link.addEventListener('click', closeMenu);
		});

		var desktopBreakpoint = window.matchMedia('(min-width: 721px)');
		var resetOnDesktop = function (event) {
			if (event.matches) {
				closeMenu();
			}
		};
		if (desktopBreakpoint.addEventListener) {
			desktopBreakpoint.addEventListener('change', resetOnDesktop);
		} else {
			desktopBreakpoint.addListener(resetOnDesktop);
		}
	})();
</script>

<style>
	header {
		margin: 0;
		padding: 0 1em;
		background: var(--bg-surface);
		border-bottom: 1px solid var(--border);
		transition: background 0.3s ease, border-color 0.3s ease;
	}
	h2 {
		margin: 0;
		font-size: 1em;
	}
	h2 a,
	h2 a.active {
		text-decoration: none;
		color: var(--accent);
	}
	nav {
		display: flex;
		align-items: center;
		justify-content: space-between;
	}
	.internal-links {
		display: flex;
		align-items: center;
	}
	nav a {
		padding: 1em 0.5em;
		color: var(--text-muted);
		border-bottom: 4px solid transparent;
		text-decoration: none;
		transition: color 0.2s ease, border-color 0.2s ease;
	}
	nav a:hover {
		color: var(--text);
	}
	nav a.active {
		text-decoration: none;
		color: var(--accent);
		border-bottom-color: var(--accent);
	}
	.icon-links {
		display: flex;
		flex-wrap: nowrap;
		flex-shrink: 0;
		align-items: center;
	}
	.icon-links a {
		display: flex;
		align-items: center;
		justify-content: center;
		color: var(--text-faint);
		padding: 0.5em;
		border: none !important;
		border-bottom: none !important;
		background: none;
		cursor: pointer;
		transition: color 0.2s ease;
	}
	#theme-toggle {
		display: flex;
		align-items: center;
		justify-content: center;
		color: var(--text-faint);
		padding: 0.5em;
		margin: 0;
		border: none;
		background: none;
		cursor: pointer;
		transition: color 0.2s ease;
		font: inherit;
		line-height: 0;
	}
	.menu-toggle {
		display: none;
		align-items: center;
		justify-content: center;
		color: var(--text-faint);
		padding: 0.5em 0.65em;
		margin-left: 0.35em;
		border: 1px solid var(--border-light);
		border-radius: 6px;
		background: none;
		cursor: pointer;
		transition: color 0.2s ease, border-color 0.2s ease;
		font: inherit;
		font-size: 0.8em;
		line-height: 1;
	}
	.menu-toggle:hover,
	.menu-toggle[aria-expanded='true'] {
		color: var(--accent);
		border-color: var(--accent);
	}
	.icon-links a:hover,
	#theme-toggle:hover {
		color: var(--accent);
	}
	.mobile-menu {
		display: none;
	}
	.mobile-links {
		display: flex;
		flex-direction: column;
	}
	.mobile-links a {
		display: block;
		padding: 0.8em 0;
		color: var(--text-muted);
		text-decoration: none;
		border-bottom: 1px solid var(--border);
	}
	.mobile-links a:last-child {
		border-bottom: none;
	}
	.mobile-links a.active {
		color: var(--accent);
		font-weight: 700;
	}
	.mobile-social-links {
		display: flex;
		gap: 0.5em;
		flex-wrap: wrap;
		padding-top: 0.8em;
		margin-top: 0.6em;
		border-top: 1px solid var(--border);
	}
	.mobile-social-links a {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		padding: 0.35em 0.65em;
		font-size: 0.8em;
		line-height: 1.2;
		border: 1px solid var(--border-light);
		border-radius: 999px;
		color: var(--text-faint);
		text-decoration: none;
		transition: color 0.2s ease, border-color 0.2s ease;
	}
	.mobile-social-links a:hover {
		color: var(--accent);
		border-color: var(--accent);
	}
	.separator {
		color: var(--border-light);
		font-size: 1.2em;
		line-height: 1;
		user-select: none;
		padding: 0 0.15em;
		flex-shrink: 0;
	}
	:global([data-theme="dark"]) .icon-sun {
		display: block;
	}
	:global([data-theme="dark"]) .icon-moon {
		display: none;
	}
	:global([data-theme="light"]) .icon-sun {
		display: none;
	}
	:global([data-theme="light"]) .icon-moon {
		display: block;
	}
	@media (max-width: 720px) {
		header {
			margin-bottom: 0.75em;
		}
		.internal-links {
			display: none;
		}
		.icon-links a {
			display: none;
		}
		.separator {
			display: none;
		}
		#theme-toggle svg {
			width: 24px;
			height: 24px;
		}
		.menu-toggle {
			display: inline-flex;
		}
		.mobile-menu {
			display: block;
			border-top: 1px solid var(--border);
			padding: 0 0.1em 0.5em;
		}
		.mobile-menu[hidden] {
			display: none;
		}
	}
</style>
